# DEBATE.md â€” í† ë¡  ê·œì¹™ ğŸ—£ï¸

## ê°œìš”
ì½”ë“œ ë¬¸ì œ ë˜ëŠ” ê¸°ìˆ ì  ì¥ì• ë¬¼ ë°œê²¬ ì‹œ, **ì—¬ëŸ¬ ìµœì‹  AI ëª¨ë¸ì—ê²Œ ë”¥ì¶”ë¡  ë¦¬ë·°**ë¥¼ ë°›ì•„ ìµœì ì˜ í•´ê²°ì±…ì„ ë„ì¶œí•˜ëŠ” í”„ë¡œì„¸ìŠ¤.

---

## í† ë¡  ë°œë™ ì¡°ê±´

1. **í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨** â€” ì˜ˆìƒëŒ€ë¡œ ì‘ë™í•˜ì§€ ì•Šì„ ë•Œ
2. **ê¸°ìˆ ì  ì¥ë²½** â€” ìš°íšŒ/í•´ê²° ë°©ë²•ì´ ë¶ˆëª…í™•í•  ë•Œ
3. **ì„¤ê³„ ê²°ì •** â€” ì—¬ëŸ¬ ë°©ë²• ì¤‘ ì„ íƒì´ í•„ìš”í•  ë•Œ
4. **ì„±ëŠ¥ ìµœì í™”** â€” ë” ë‚˜ì€ ë°©ë²•ì´ ìˆì„ ìˆ˜ ìˆì„ ë•Œ

---

## í† ë¡  í”„ë¡œì„¸ìŠ¤

### 1ë‹¨ê³„: ë¬¸ì œ ì •ì˜
```
- í˜„ì¬ ìƒí™© (ì½”ë“œ, ì—ëŸ¬ ë©”ì‹œì§€)
- ê¸°ëŒ€ ê²°ê³¼
- ì‹¤ì œ ê²°ê³¼
```

### 2ë‹¨ê³„: í† ë¡  ì˜íšŒ ì†Œì§‘
```python
# ìµœì†Œ 2ê°œ ëª¨ë¸ì—ê²Œ ë™ì‹œ ì§ˆë¬¸
sessions_spawn(
    task="ë¬¸ì œ ì„¤ëª… + ì§ˆë¬¸",
    model="openai/o3",
    thinking="high",
    label="o3-review"
)
sessions_spawn(
    task="ë™ì¼ ì§ˆë¬¸",
    model="anthropic/claude-opus-4-6",
    thinking="high", 
    label="opus-review"
)
```

### 3ë‹¨ê³„: ê²°ê³¼ ì¢…í•©
- ê³µí†µì  ì¶”ì¶œ â†’ **í•µì‹¬ í•´ê²°ì±…**
- ì°¨ì´ì  ë¶„ì„ â†’ ì¶”ê°€ ê³ ë ¤ì‚¬í•­
- ì‹¤í–‰ ê°€ëŠ¥í•œ ì½”ë“œ ë„ì¶œ

### 4ë‹¨ê³„: ì ìš© ë° í…ŒìŠ¤íŠ¸
- ì½”ë“œ ìˆ˜ì •
- í…ŒìŠ¤íŠ¸ ì‹¤í–‰
- ê²°ê³¼ ê¸°ë¡

---

## í† ë¡  ëª¨ë¸ í’€ (2026-02 ê¸°ì¤€)

| ëª¨ë¸ | ìš©ë„ | ê°•ì  |
|------|------|------|
| `openai/o3` | ì¶”ë¡ , ë¶„ì„ | ê¹Šì€ ì‚¬ê³ , ì›¹ ë¦¬ì„œì¹˜ |
| `anthropic/claude-opus-4-6` | ì½”ë“œ, ë¶„ì„ | ìƒì„¸í•œ ì„¤ëª…, ì½”ë“œ ì˜ˆì‹œ |
| `openai/codex-5.2` | ì½”ë“œ ìƒì„± | ì½”ë“œ íŠ¹í™” |

---

## í† ë¡  ë¡œê·¸

### 2026-02-12: Turnstile í† í° ì£¼ì… ë¬¸ì œ
- **ë¬¸ì œ:** CapSolver í† í° íšë“ ì„±ê³µ, ì£¼ì… í›„ ë²„íŠ¼ ë¹„í™œì„±í™”
- **í† ë¡ :** O3 + Opus 4.6 (ë”¥ì¶”ë¡  high)
- **ê³µí†µ ê²°ë¡ :** `add_init_script`ë¡œ ì½œë°± ì¸í„°ì…‰íŠ¸ í•„ìš”
- **ê²°ê³¼:** âœ… ë¡œê·¸ì¸ ì„±ê³µ!

---

## ê·œì¹™

1. **í† ë¡ ì€ ë”¥ì¶”ë¡  ëª¨ë“œ(thinking: high)ë¡œ**
2. **ì›¹ ë¦¬ì„œì¹˜ í¬í•¨** â€” ìµœì‹  ì •ë³´ ë°˜ì˜
3. **ìµœì†Œ 2ê°œ ëª¨ë¸** â€” ë‹¨ì¼ ëª¨ë¸ í¸í–¥ ë°©ì§€
4. **ê²°ê³¼ ë¬¸ì„œí™”** â€” ë‚˜ì¤‘ì— ì°¸ê³ 
5. **í…ŒìŠ¤íŠ¸ë¡œ ê²€ì¦** â€” í† ë¡  ê²°ê³¼ ì ìš© í›„ ë°˜ë“œì‹œ í…ŒìŠ¤íŠ¸

---

*"í˜¼ì ìƒê°í•˜ì§€ ë§ê³ , ì˜íšŒë¥¼ ì—´ì–´ë¼"* ğŸ›ï¸

---

### 2026-02-12: ì•¼ë†€ì SSO ë¦¬ë‹¤ì´ë ‰íŠ¸ + ì˜ˆë§¤ ë²„íŠ¼ ë¬¸ì œ

#### ğŸ” ë¬¸ì œ ìš”ì•½
| ë¬¸ì œ | ìƒíƒœ | ì‹¬ê°ë„ |
|------|------|--------|
| ì•¼ë†€ì ë¡œê·¸ì¸ í›„ ì˜ˆë§¤ í´ë¦­ ì‹œ ì¬ë¡œê·¸ì¸ ìš”êµ¬ | ğŸ”´ Critical | P0 |
| ëª¨ë‹¬ pointer intercept (backdrop ì°¨ë‹¨) | ğŸŸ¡ í•´ê²°ë¨ | P2 |
| ì˜ˆë§¤ ë²„íŠ¼ `href="#"` (JS ì´ë²¤íŠ¸ë§Œ ì‘ë™) | ğŸŸ¡ ë¶€ë¶„í•´ê²° | P1 |

#### ğŸ—ï¸ ì¸í„°íŒŒí¬-ì•¼ë†€ì SSO êµ¬ì¡° ë¶„ì„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    NOL Universe (ì•¼ë†€ì í”Œë«í¼)                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ accounts.       â”‚    â”‚ nol.interpark.  â”‚    â”‚ tickets.    â”‚ â”‚
â”‚  â”‚ yanolja.com     â”‚â—„â”€â”€â–ºâ”‚ com/ticket      â”‚â—„â”€â”€â–ºâ”‚interpark.comâ”‚ â”‚
â”‚  â”‚ (ì¤‘ì•™ ì¸ì¦)      â”‚    â”‚ (ì‹ ê·œ UI)       â”‚    â”‚ (ë ˆê±°ì‹œ)     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                       â”‚                     â”‚         â”‚
â”‚         â–¼                       â–¼                     â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚              ì¿ í‚¤ ë„ë©”ì¸: .yanolja.com (ê³µìœ )               â”‚â”‚
â”‚  â”‚              ì¿ í‚¤ ë„ë©”ì¸: .interpark.com (ë³„ë„)             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**í•µì‹¬ ë°œê²¬:**
1. `accounts.yanolja.com` = ì¤‘ì•™ OAuth2 ì¸ì¦ ì„œë²„
2. `.yanolja.com` ì¿ í‚¤ëŠ” `nol.interpark.com`ì—ì„œ ì ‘ê·¼ ë¶ˆê°€ (ë‹¤ë¥¸ ë„ë©”ì¸)
3. ë¡œê·¸ì¸ ì„±ê³µ ì‹œ `redirect` íŒŒë¼ë¯¸í„°ë¡œ `accounts.interpark.com/login/success/nol`ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
4. ì´ ê³¼ì •ì—ì„œ `interpark.com` ë„ë©”ì¸ì— ì„¸ì…˜ ì¿ í‚¤ ì„¤ì •

#### âŒ ë¬¸ì œ ì›ì¸

**1. í¬ë¡œìŠ¤ ë„ë©”ì¸ ì¿ í‚¤ ë™ê¸°í™” ì‹¤íŒ¨**
```
ë¡œê·¸ì¸ í”Œë¡œìš°:
accounts.yanolja.com â†’ ë¡œê·¸ì¸ ì„±ê³µ 
                     â†’ accounts.interpark.com/login/success/nol
                     â†’ nol.interpark.com/ticket (ì¿ í‚¤ ì„¤ì •ë¨)

ì˜ˆë§¤ í”Œë¡œìš°:
tickets.interpark.com/goods/XXX â†’ ì˜ˆë§¤ í´ë¦­
                                â†’ ì„¸ì…˜ í™•ì¸ (interpark.com ì¿ í‚¤)
                                â†’ âŒ ì„¸ì…˜ ì—†ìŒ â†’ ì¬ë¡œê·¸ì¸ ìš”êµ¬
```

**2. ë ˆê±°ì‹œ vs ì‹ ê·œ ë„ë©”ì¸ ì¶©ëŒ**
- `nol.interpark.com` (ì‹ ê·œ) â‰  `tickets.interpark.com` (ë ˆê±°ì‹œ)
- ê°™ì€ `.interpark.com` ë„ë©”ì¸ì´ì§€ë§Œ ì„œë¸Œë„ë©”ì¸ë³„ ì„¸ì…˜ ê²©ë¦¬

**3. ì˜ˆë§¤ ë²„íŠ¼ JavaScript ì´ë²¤íŠ¸**
```html
<a class="sideBtn is-primary" href="#">ì˜ˆë§¤í•˜ê¸°</a>
```
- `href="#"`ëŠ” í˜ì´ì§€ ì´ë™ ì—†ìŒ
- JavaScript `onclick` í•¸ë“¤ëŸ¬ê°€ ëª¨ë‹¬/íŒì—… ì—´ê¸° ë‹´ë‹¹
- Playwrightì˜ `.click()`ì´ ì´ë²¤íŠ¸ ë²„ë¸”ë§ ë¬¸ì œë¡œ ì‹¤íŒ¨ ê°€ëŠ¥

#### âœ… í•´ê²° ì „ëµ (3ê°€ì§€ ë°©ì•ˆ)

##### ë°©ì•ˆ 1: Storage State ì¬ì‚¬ìš© (ê¶Œì¥) â­
```python
# 1. ë¡œê·¸ì¸ í›„ ìƒíƒœ ì €ì¥
login_url = "https://accounts.yanolja.com/signin/email?clientId=ticket-pc&..."
page.goto(login_url)
# ... ë¡œê·¸ì¸ ìˆ˜í–‰ ...

# ì„¸ì…˜ ì €ì¥ (ì¿ í‚¤ + localStorage)
context.storage_state(path="auth_state.json")

# 2. ìƒˆ ì„¸ì…˜ì—ì„œ ìƒíƒœ ë³µì›
context = browser.new_context(storage_state="auth_state.json")
page = context.new_page()
page.goto("https://tickets.interpark.com/goods/XXX")  # ë¡œê·¸ì¸ ìœ ì§€ë¨
```

##### ë°©ì•ˆ 2: ìˆ˜ë™ ì¿ í‚¤ ë³µì‚¬
```python
# ë¡œê·¸ì¸ í›„ ëª¨ë“  ì¿ í‚¤ ìˆ˜ì§‘
all_cookies = context.cookies()

# interpark.com ë„ë©”ì¸ ì¿ í‚¤ í•„í„°ë§ ë° ë³µì‚¬
for cookie in all_cookies:
    if "yanolja" in cookie["domain"] or "interpark" in cookie["domain"]:
        # ì„œë¸Œë„ë©”ì¸ì—ë„ ì ìš©ë˜ë„ë¡ ìˆ˜ì •
        if cookie["domain"].startswith("."):
            continue  # ì´ë¯¸ ì™€ì¼ë“œì¹´ë“œ
        cookie["domain"] = "." + cookie["domain"].lstrip(".")
        context.add_cookies([cookie])
```

##### ë°©ì•ˆ 3: nol.interpark.com ë„ë©”ì¸ ìœ ì§€
```python
# tickets.interpark.com ëŒ€ì‹  nol ë„ë©”ì¸ ì‚¬ìš©
CONCERT_URL = "https://nol.interpark.com/ticket/goods/XXX"  # â† ë³€ê²½

# ë˜ëŠ” goods URL ë³€í™˜
def convert_to_nol_url(tickets_url):
    """tickets.interpark.com â†’ nol.interpark.com ë³€í™˜"""
    if "tickets.interpark.com" in tickets_url:
        goods_id = re.search(r'/goods/(\d+)', tickets_url).group(1)
        return f"https://nol.interpark.com/ticket/goods/{goods_id}"
    return tickets_url
```

#### ğŸ”§ ì˜ˆë§¤ ë²„íŠ¼ í´ë¦­ ê°œì„ 

```python
def click_booking_button_improved(self) -> bool:
    """ê°œì„ ëœ ì˜ˆë§¤ ë²„íŠ¼ í´ë¦­"""
    
    # ë°©ë²• 1: JavaScript ì´ë²¤íŠ¸ ì§ì ‘ íŠ¸ë¦¬ê±°
    clicked = self.page.evaluate('''() => {
        const btn = document.querySelector('a.sideBtn.is-primary');
        if (btn) {
            // 1. ë„¤ì´í‹°ë¸Œ í´ë¦­ ì´ë²¤íŠ¸
            const clickEvent = new MouseEvent('click', {
                bubbles: true,
                cancelable: true,
                view: window
            });
            btn.dispatchEvent(clickEvent);
            
            // 2. onclick í•¸ë“¤ëŸ¬ ì§ì ‘ í˜¸ì¶œ
            if (typeof btn.onclick === 'function') {
                btn.onclick();
            }
            
            return true;
        }
        return false;
    }''')
    
    if clicked:
        # íŒì—… ëŒ€ê¸°
        try:
            with self.page.expect_popup(timeout=10000) as popup_info:
                pass  # ì´ë¯¸ í´ë¦­ë¨
            self.booking_page = popup_info.value
            return True
        except:
            pass
    
    # ë°©ë²• 2: force=True + ì¢Œí‘œ í´ë¦­
    btn = self.page.locator('a.sideBtn.is-primary:has-text("ì˜ˆë§¤í•˜ê¸°")').first
    if btn.is_visible():
        box = btn.bounding_box()
        if box:
            # ì •í™•í•œ ì¤‘ì•™ í´ë¦­
            self.page.mouse.click(
                box['x'] + box['width'] / 2,
                box['y'] + box['height'] / 2
            )
            return True
    
    return False
```

#### ğŸ“‹ ì¶”ì²œ êµ¬í˜„ ìˆœì„œ

1. **ì¦‰ì‹œ ì ìš©**: `nol.interpark.com` ë„ë©”ì¸ìœ¼ë¡œ URL ë³€í™˜ (ë°©ì•ˆ 3)
2. **ì¤‘ê¸° ê°œì„ **: `storage_state` ì €ì¥/ë³µì› ì¶”ê°€ (ë°©ì•ˆ 1)
3. **ì¥ê¸° ë³´ì™„**: ì¿ í‚¤ ë™ê¸°í™” ìœ í‹¸ë¦¬í‹° (ë°©ì•ˆ 2)

#### ğŸ§ª í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] `--login-only` í…ŒìŠ¤íŠ¸ í›„ `auth_state.json` ìƒì„± í™•ì¸
- [ ] nol.interpark.com ë„ë©”ì¸ì—ì„œ ì˜ˆë§¤ ë²„íŠ¼ í´ë¦­ í…ŒìŠ¤íŠ¸
- [ ] íŒì—… ì°½ ê°ì§€ ë° í•¸ë“¤ë§ í™•ì¸
- [ ] ëŒ€ê¸°ì—´ â†’ ì¢Œì„ì„ íƒ í”Œë¡œìš° ì •ìƒ ë™ì‘ í™•ì¸

#### ğŸ“š ì°¸ê³  ìë£Œ

- [Playwright Authentication Docs](https://playwright.dev/docs/auth)
- [Cross-domain Cookie Sharing](https://scrapingant.com/blog/playwright-set-cookies)
- [SSO Redirect Handling](https://www.checklyhq.com/docs/learn/playwright/authentication/)

---

## 2026-02-12: ì•¼ë†€ì SSO ë¦¬ë‹¤ì´ë ‰íŠ¸ ë¬¸ì œ (Opus í† ë¡  ì˜ì›)

### ğŸ”´ ë¬¸ì œ ì •ì˜

**í˜„ì¬ ìƒí™©:**
```
1. ì¸í„°íŒŒí¬ ê³„ì •ìœ¼ë¡œ accounts.yanolja.com ë¡œê·¸ì¸ ì„±ê³µ âœ…
2. ê³µì—° ìƒì„¸ í˜ì´ì§€(tickets.interpark.com/goods/...) ì ‘ì† âœ…  
3. "ì˜ˆë§¤í•˜ê¸°" ë²„íŠ¼ í´ë¦­ â†’ accounts.yanolja.com ìœ¼ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ âŒ
```

**ì¶”ê°€ ë°œê²¬:**
- `<html lang="ko">` ìš”ì†Œê°€ ëª¨ë“  í´ë¦­ì„ ê°€ë¡œì±” (ëª¨ë‹¬ ë°±ë“œë¡­)
- ì˜ˆë§¤ ë²„íŠ¼: `<a class="sideBtn is-primary" href="#">ì˜ˆë§¤í•˜ê¸°</a>` (JS ì´ë²¤íŠ¸ë§Œ)

---

### ğŸ” SSO êµ¬ì¡° ë¶„ì„

**ì•¼ë†€ì-ì¸í„°íŒŒí¬ NOL í†µí•© êµ¬ì¡°:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  accounts.yanolja.com                    â”‚
â”‚                   (ì¤‘ì•™ ì¸ì¦ ì„œë²„)                        â”‚
â”‚                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ ì•¼ë†€ì ì•±     â”‚    â”‚ NOL í†µí•©     â”‚    â”‚ ì¸í„°íŒŒí¬   â”‚ â”‚
â”‚  â”‚ nol.yanolja  â”‚    â”‚ nol.interparkâ”‚    â”‚ tickets.   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¡œê·¸ì¸ URL ë¶„ì„:**
```
https://accounts.yanolja.com/signin/email
  ?clientId=ticket-pc              â† ì¸í„°íŒŒí¬ í‹°ì¼“ í´ë¼ì´ì–¸íŠ¸
  &postProc=FULLSCREEN
  &origin=https://nol.interpark.com/ticket
  &service=interpark-ticket
```

**í•µì‹¬ ë°œê²¬:**
1. `clientId=ticket-pc` â†’ ì¸í„°íŒŒí¬ í‹°ì¼“ ì „ìš© ì„¸ì…˜
2. ì•¼ë†€ì ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•´ë„ **ì„œë¹„ìŠ¤ë³„ ì„¸ì…˜ í† í°**ì´ ë³„ë„ ë°œê¸‰ë¨
3. ì˜ˆë§¤ ì‹œ ì¶”ê°€ ì¸ì¦ í•„ìš” â†’ **í‹°ì¼“ êµ¬ë§¤ ì „ìš© ì„¸ì…˜** ìš”êµ¬

---

### ğŸ¯ ë¦¬ë‹¤ì´ë ‰íŠ¸ ì›ì¸ ë¶„ì„

**ê°€ì„¤ 1: ì„¸ì…˜ í† í° ìŠ¤ì½”í”„ ë¶ˆì¼ì¹˜** â­ ìœ ë ¥
```
ë¡œê·¸ì¸ ì‹œ: clientId=ticket-pc â†’ ì¡°íšŒìš© ì„¸ì…˜
ì˜ˆë§¤ ì‹œ: êµ¬ë§¤ìš© ì„¸ì…˜ í•„ìš” â†’ accounts.yanolja.com ë¦¬ë‹¤ì´ë ‰íŠ¸
```

**ê°€ì„¤ 2: ì¿ í‚¤ ë„ë©”ì¸ ë¶„ë¦¬**
```
accounts.yanolja.com  â†’ ì¸ì¦ ì¿ í‚¤
nol.interpark.com     â†’ ì„œë¹„ìŠ¤ ì¿ í‚¤ (ì „íŒŒ ì•ˆë¨?)
tickets.interpark.com â†’ êµ¬ë§¤ ì¿ í‚¤ (ë³„ë„ í•„ìš”)
```

**ê°€ì„¤ 3: ì˜ˆë§¤ ë²„íŠ¼ JS ë¡œì§**
```javascript
// ì˜ˆë§¤ ë²„íŠ¼ í´ë¦­ ì‹œ ë‚´ë¶€ ë¡œì§ (ì¶”ì •)
onClick: async () => {
  const authCheck = await checkPurchaseAuth();
  if (!authCheck.valid) {
    window.location.href = accounts.yanolja.com + '?returnUrl=...';
  }
}
```

---

### ğŸ’¡ í•´ê²° ì „ëµ ì˜µì…˜

#### ì˜µì…˜ A: ì•¼ë†€ì ê³„ì • ì‚¬ì „ ì—°ë™ (ìµœìš°ì„  â­)

**ë°©ë²•:** ì¸í„°íŒŒí¬ ê³„ì •ì´ ì•¼ë†€ì NOL ê³„ì •ê³¼ ì—°ë™ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
```
1. https://nol.yanolja.com ì ‘ì†
2. ë§ˆì´í˜ì´ì§€ â†’ ê³„ì • ì„¤ì • â†’ ì—°ë™ ì„œë¹„ìŠ¤ í™•ì¸
3. "ì¸í„°íŒŒí¬ í‹°ì¼“" ì—°ë™ í™œì„±í™”
```

**ì¥ì :** í•œ ë²ˆ ì„¤ì •í•˜ë©´ ì˜êµ¬ í•´ê²°
**ë‹¨ì :** ìˆ˜ë™ ì„¤ì • í•„ìš”, ì‚¬ìš©ìë§ˆë‹¤ ë‹¤ë¦„

---

#### ì˜µì…˜ B: ë™ì  ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬ (ì½”ë“œ ìˆ˜ì •)

```python
def handle_yanolja_redirect(self) -> bool:
    """ì•¼ë†€ì ë¦¬ë‹¤ì´ë ‰íŠ¸ ê°ì§€ ë° ì¬ë¡œê·¸ì¸"""
    
    for _ in range(30):  # 30ì´ˆ ëŒ€ê¸°
        current_url = self.page.url.lower()
        
        # ì•¼ë†€ì ë¡œê·¸ì¸ í˜ì´ì§€ ê°ì§€
        if 'accounts.yanolja.com' in current_url:
            self._log('ğŸ”„ ì•¼ë†€ì ì¬ì¸ì¦ í•„ìš” - ë¡œê·¸ì¸ ì²˜ë¦¬...')
            
            # ì´ë¯¸ ì…ë ¥ í•„ë“œê°€ ìˆìœ¼ë©´ ì¬ë¡œê·¸ì¸
            try:
                email_input = self.page.locator('input[name="email"]')
                if email_input.is_visible(timeout=3000):
                    return self._perform_login()
            except:
                pass
            
            # ìë™ ë¦¬ë‹¤ì´ë ‰íŠ¸ ëŒ€ê¸° (ì´ë¯¸ ì„¸ì…˜ ìˆìœ¼ë©´)
            adaptive_sleep(2)
            continue
        
        # ì˜ˆë§¤ í˜ì´ì§€ ë„ë‹¬ í™•ì¸
        if 'book' in current_url or 'seat' in current_url:
            return True
        
        adaptive_sleep(1)
    
    return False
```

**ì¥ì :** ìë™í™” ê°€ëŠ¥
**ë‹¨ì :** 2ì¤‘ ë¡œê·¸ì¸ ì‹œê°„ ì†Œìš”

---

#### ì˜µì…˜ C: ì¿ í‚¤ ì‚¬ì „ ì£¼ì…

```python
def inject_yanolja_cookies(self):
    """ì•¼ë†€ì ì¿ í‚¤ë¥¼ ì‚¬ì „ì— ì£¼ì…"""
    
    # 1. ë¨¼ì € ì•¼ë†€ì ë„ë©”ì¸ ë°©ë¬¸
    self.page.goto('https://nol.yanolja.com', wait_until='domcontentloaded')
    
    # 2. ë¡œê·¸ì¸ í›„ ì¿ í‚¤ ì €ì¥
    cookies = self.context.cookies()
    
    # 3. ì¸í„°íŒŒí¬ ë„ë©”ì¸ì—ë„ ì¿ í‚¤ ë³µì‚¬ (ê°€ëŠ¥í•œ ê²½ìš°)
    for cookie in cookies:
        if 'yanolja' in cookie.get('domain', ''):
            # ê´€ë ¨ ì¿ í‚¤ ì €ì¥
            pass
```

**ì¥ì :** ì„¸ì…˜ ê³µìœ  ê°€ëŠ¥
**ë‹¨ì :** ì¿ í‚¤ êµ¬ì¡° ë¶„ì„ í•„ìš”

---

#### ì˜µì…˜ D: ì•¼ë†€ìì—ì„œ ì‹œì‘ (ì™„ì „í•œ í”Œë¡œìš°)

```python
# ì¸í„°íŒŒí¬ê°€ ì•„ë‹Œ NOL ì•¼ë†€ìì—ì„œ ì‹œì‘
LOGIN_BASE = 'https://nol.yanolja.com'  # ë³€ê²½

def login_via_yanolja(self):
    """ì•¼ë†€ì NOLì—ì„œ ë¡œê·¸ì¸ í›„ ì¸í„°íŒŒí¬ë¡œ ì´ë™"""
    
    # 1. ì•¼ë†€ì NOL ë¡œê·¸ì¸
    self.page.goto('https://nol.yanolja.com')
    # ë¡œê·¸ì¸ ë²„íŠ¼ í´ë¦­ â†’ accounts.yanolja.com
    # ... ë¡œê·¸ì¸ ìˆ˜í–‰ ...
    
    # 2. ì¸í„°íŒŒí¬ í‹°ì¼“ìœ¼ë¡œ ì´ë™
    self.page.goto('https://nol.interpark.com/ticket')
    
    # 3. ê³µì—° í˜ì´ì§€ë¡œ ì´ë™
    self.page.goto(self.config.url)
```

**ì¥ì :** ì™„ì „í•œ ì„¸ì…˜ íšë“
**ë‹¨ì :** í”Œë¡œìš° ë³µì¡

---

### ğŸ“‹ ê¶Œì¥ ì‹¤í–‰ ê³„íš

```
1. [ì¦‰ì‹œ] ì˜µì…˜ A í™•ì¸ - ê³„ì • ì—°ë™ ìƒíƒœ ì²´í¬
   â””â”€â”€ ì—°ë™ ì•ˆë˜ì–´ ìˆìœ¼ë©´ ìˆ˜ë™ ì—°ë™

2. [ì½”ë“œ] ì˜µì…˜ B êµ¬í˜„ - ë™ì  ë¦¬ë‹¤ì´ë ‰íŠ¸ ì²˜ë¦¬
   â””â”€â”€ click_booking_button() ì´í›„ handle_yanolja_redirect() í˜¸ì¶œ

3. [í´ë°±] ì˜µì…˜ D - ì•¼ë†€ìì—ì„œ ì‹œì‘í•˜ëŠ” í”Œë¡œìš°
   â””â”€â”€ ì˜µì…˜ B ì‹¤íŒ¨ ì‹œ ì ìš©
```

---

### ğŸ”§ ëª¨ë‹¬/ë²„íŠ¼ ë¬¸ì œ í•´ê²° (ì´ë¯¸ ì ìš©ë¨)

```python
# force=Trueë¡œ ëª¨ë‹¬ ë°±ë“œë¡­ ìš°íšŒ
modal_btn.click(force=True, timeout=5000)

# JavaScriptë¡œ ì§ì ‘ í´ë¦­ (href="#" ë²„íŠ¼)
self.page.evaluate('''
    var links = document.querySelectorAll('a, button');
    for (var link of links) {
        if (link.textContent && link.textContent.includes('ì˜ˆë§¤')) {
            link.click();
            break;
        }
    }
''')
```

---

### âœ… ë‹¤ìŒ ì•¡ì…˜

1. **í…ŒìŠ¤íŠ¸:** `--login-only` í›„ ìˆ˜ë™ìœ¼ë¡œ ì˜ˆë§¤ ë²„íŠ¼ í´ë¦­ â†’ ë¦¬ë‹¤ì´ë ‰íŠ¸ URL í™•ì¸
2. **ë¶„ì„:** ë¦¬ë‹¤ì´ë ‰íŠ¸ URLì˜ `returnUrl` íŒŒë¼ë¯¸í„° í™•ì¸
3. **êµ¬í˜„:** `handle_yanolja_redirect()` í•¨ìˆ˜ ì¶”ê°€
4. **ê²€ì¦:** ì „ì²´ í”Œë¡œìš° í…ŒìŠ¤íŠ¸

---

*í† ë¡  ì™„ë£Œ: 2026-02-12 12:08 KST*
